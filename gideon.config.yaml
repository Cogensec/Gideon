# Gideon Configuration File
# Cybersecurity Operations Assistant

sources:
  # National Vulnerability Database
  nvd:
    enabled: true
    base_url: "https://services.nvd.nist.gov/rest/json/cves/2.0"
    rate_limit: 5  # requests per second (with API key)
    cache_ttl: 900  # 15 minutes

  # CISA Known Exploited Vulnerabilities
  cisa_kev:
    enabled: true
    base_url: "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"
    rate_limit: 1  # requests per second
    cache_ttl: 3600  # 1 hour

  # VirusTotal
  virustotal:
    enabled: true
    base_url: "https://www.virustotal.com/api/v3"
    rate_limit: 4  # requests per minute (free tier)
    cache_ttl: 300  # 5 minutes

  # AbuseIPDB
  abuseipdb:
    enabled: true
    base_url: "https://api.abuseipdb.com/api/v2"
    rate_limit: 1000  # requests per day (free tier)
    cache_ttl: 600  # 10 minutes

output:
  # Output formats to generate
  formats:
    - markdown
    - json

  # Directory for saving outputs
  directory: ./outputs

  # Include STIX format (optional)
  include_stix: false

  # Redaction of sensitive data
  redaction:
    enabled: true
    patterns:
      # API keys, tokens, passwords
      - "(?i)(api[_-]?key|token|password|secret)\\s*[:=]\\s*['\"]?([^'\"\\s]{8,})"
      # Bearer tokens
      - "(?i)(bearer\\s+[a-zA-Z0-9\\-_]+\\.?[a-zA-Z0-9\\-_]*\\.?[a-zA-Z0-9\\-_]*)"
      # Private keys
      - "-----BEGIN.*PRIVATE KEY-----[\\s\\S]*?-----END.*PRIVATE KEY-----"

agent:
  # Maximum iterations for agent loop
  max_iterations: 10

  # Minimum confidence threshold for findings
  confidence_threshold: 0.6

  # Minimum number of sources for corroboration
  min_corroboration_sources: 2

  # Enable verification steps
  enable_verification: true

safety:
  # Defensive mode only (blocks offensive capabilities)
  defensive_mode: true

  # Block generation of offensive content
  block_offensive: true

  # Require explicit authorization for sensitive operations
  require_explicit_auth: false  # Set to true in production environments

# OpenRouter Configuration (Unified API for 400+ models)
openrouter:
  # Enable OpenRouter integration
  enabled: true

  # API base URL (default: https://openrouter.ai/api/v1)
  base_url: "https://openrouter.ai/api/v1"

  # Cache TTL for model list (seconds)
  cache_ttl: 900  # 15 minutes


# Agent Security Governance Configuration
governance:
  # Enable governance features
  enabled: true

  # Agent registry settings
  registry:
    # Auto-activate agents from trusted sources
    auto_activate_trusted: false
    # Trusted agent sources (owners)
    trusted_sources: []
    # Maximum agents per owner
    max_agents_per_owner: 10
    # Stale agent threshold (minutes)
    stale_threshold_minutes: 30

  # Policy enforcement settings
  policies:
    # Default action when no policy matches
    default_action: allow  # allow, deny, audit
    # Enable real-time policy evaluation
    realtime_evaluation: true
    # Log all policy evaluations
    log_all_evaluations: false

  # Monitoring settings
  monitoring:
    # Enable behavioral profiling
    behavioral_profiling: true
    # Anomaly detection sensitivity (0.0-1.0)
    anomaly_sensitivity: 0.7
    # Activity buffer size
    activity_buffer_size: 1000
    # Auto-quarantine on critical violations
    auto_quarantine_critical: true

  # Access control settings
  access_control:
    # Default permission expiry (hours, 0 = never)
    default_expiry_hours: 0
    # Require justification for access requests
    require_justification: true
    # Auto-cleanup expired permissions
    auto_cleanup_expired: true

  # Audit settings
  audit:
    # Enable hash chain verification
    hash_chain_enabled: true
    # Log retention (days)
    retention_days: 30
    # Max log file size (bytes)
    max_log_size: 10485760  # 10MB
    # Generate compliance reports automatically
    auto_compliance_report: false
# Voice configuration (NVIDIA PersonaPlex)
voice:
  # Enable voice capabilities
  enabled: true

  # Default voice ID (NATM0-3, NATF0-3, VARM0-4, VARF0-4)
  voice_id: NATM1

  # Use CPU offload for lower GPU memory usage (higher latency)
  cpu_offload: true

  # Gideon security analyst persona for voice interactions
  persona: |
    You are Gideon, a professional cybersecurity analyst assistant.
    You provide clear, concise security briefings and threat intelligence analysis.
    Speak with authority but remain approachable and helpful.
    When discussing vulnerabilities, be precise about severity levels and remediation steps.
    You focus exclusively on defensive security - never provide offensive guidance,
    exploitation techniques, or help with attacking systems.
    Keep responses focused and actionable for security defenders.

# NVIDIA NeMo Guardrails configuration
guardrails:
  # Enable NeMo Guardrails integration
  enabled: true

  # NeMo Guardrails service URL (default: localhost:7331)
  # Can also be set via NEMO_GUARDRAILS_URL environment variable
  service_url: http://localhost:7331

  # Input rails - applied to user queries before processing
  input_rails:
    # Detect and block jailbreak attempts (trained on 17K known jailbreaks)
    jailbreak_detection: true
    # Ensure queries stay within allowed security topics
    topic_control: true

  # Output rails - applied to LLM responses before returning
  output_rails:
    # Check responses for harmful or inappropriate content
    content_safety: true

  # Allowed security topics for topic control
  allowed_topics:
    - cybersecurity
    - vulnerability analysis
    - threat intelligence
    - security hardening
    - incident response
    - malware analysis
    - network security
    - compliance
    - cloud security
    - identity management

  # Blocked topics (offensive security)
  blocked_topics:
    - offensive security
    - exploitation techniques
    - malware development
    - attack tools
    - hacking tutorials
    - social engineering attacks

  # Confidence thresholds for blocking
  thresholds:
    jailbreak: 0.7
    content_safety: 0.8

# NVIDIA Morpheus configuration (Threat Detection AI)
morpheus:
  # Enable Morpheus integration
  enabled: true

  # Morpheus server URL
  server_url: http://localhost:8080

  # Available pipelines
  pipelines:
    # Digital Fingerprinting - Detect anomalous user/system behavior
    digital_fingerprinting:
      enabled: true
      model: dfp-cloudtrail
      # Anomaly score threshold (0.0-1.0)
      anomaly_threshold: 0.7

    # DGA Detection - Identify malware domain generation algorithms
    dga_detection:
      enabled: true
      model: dga-lstm
      # Confidence threshold for flagging domains
      confidence_threshold: 0.8

    # Phishing Detection - NLP-based email analysis
    phishing_detection:
      enabled: true
      model: phishing-bert
      # Confidence threshold for phishing classification
      confidence_threshold: 0.75

    # Ransomware Detection - Behavioral pattern detection
    ransomware_detection:
      enabled: true
      model: ransomware-appshield
      # Confidence threshold for ransomware detection
      confidence_threshold: 0.85

# NVIDIA RAPIDS configuration (Accelerated Data Processing)
rapids:
  # Enable RAPIDS integration
  enabled: true

  # RAPIDS server URL
  server_url: http://localhost:8090

  # Processing settings
  processing:
    # Batch size for parallel processing
    batch_size: 10000
    # GPU memory limit
    memory_limit: 8GB

  # Analytics settings
  analytics:
    # Anomaly detection threshold (0.0-1.0)
    anomaly_threshold: 0.8
    # Minimum cluster size for threat clustering
    min_cluster_size: 5
    # Maximum graph traversal depth
    max_graph_depth: 10

  # Available operations
  operations:
    # Batch IOC analysis with cuDF
    batch_ioc:
      enabled: true
      # Enable threat intel enrichment
      enrichment: true
      # Deduplicate indicators
      dedup: true

    # Event correlation with cuGraph
    correlation:
      enabled: true
      # Time window for correlation
      time_window: 24h
      # Minimum chain length to report
      min_chain_length: 3

    # Threat clustering with cuML
    clustering:
      enabled: true
      # Default algorithm: dbscan, hdbscan, kmeans
      algorithm: hdbscan

    # Network graph analysis with cuGraph
    graph_analysis:
      enabled: true
      # Detect lateral movement paths
      detect_lateral_movement: true
      # Find central/high-risk nodes
      find_central_nodes: true

    # Anomaly detection with cuML
    anomaly_detection:
      enabled: true
      # Default method: isolation_forest, local_outlier_factor, autoencoder
      method: isolation_forest

# ============================================================================
# OpenClaw Sidecar Security Platform
# ============================================================================
# Gideon security sidecar for OpenClaw agent deployments.
# Provides comprehensive security monitoring, threat detection, and hardening
# for self-hosted OpenClaw instances.
#
# Addresses:
# - CVE-2026-25253 (One-click RCE via token exfiltration, CVSS 8.8)
# - CVE-2026-24763 (Command injection)
# - CVE-2026-25157 (Second command injection)
# - CVE-2026-22708 (Indirect prompt injection via web browsing)
# - ClawHavoc campaign (800+ malicious ClawHub skills)
# - Plaintext credential storage
# - Memory poisoning attacks
openclaw:
  # Enable the OpenClaw security sidecar
  enabled: true

  # Gateway connection settings
  gateway:
    # WebSocket URL of the OpenClaw gateway
    gateway_url: "ws://127.0.0.1:18789"
    # Authentication token (prefer OPENCLAW_GATEWAY_TOKEN env var)
    # auth_token: ""
    # How the gateway is bound: localhost, lan, tailnet, custom
    bind_mode: localhost
    # Path to OpenClaw home directory
    openclaw_home: "~/.openclaw"
    # Reconnection interval (ms)
    reconnect_interval_ms: 5000
    # Maximum reconnection attempts
    max_reconnect_attempts: 10

  # Gateway Sentinel (Workstream 1) - Real-time traffic analysis
  sentinel:
    enabled: true
    # Monitor WebSocket traffic for attack patterns
    monitor_traffic: true
    # Build behavioral profiles for session anomaly detection
    behavioral_profiling: true
    # Auto-respond to critical threats (quarantine/kill session)
    auto_response: false
    # Detect CVE-2026-25253 kill chain patterns
    detect_cve_2026_25253: true

  # ClawHub Skill Scanner (Workstream 2) - Skill vetting
  skill_scanner:
    enabled: true
    # Scan skills before installation
    scan_before_install: true
    # Block skills with critical findings
    block_critical: true
    # Cross-reference IOCs with VirusTotal/AbuseIPDB
    check_iocs: true
    # Analyze publisher account reputation
    publisher_analysis: true

  # Prompt Injection Defense (Workstream 3) - Injection detection
  injection_defense:
    enabled: true
    # Scan web content ingested by agent browser
    scan_web_content: true
    # Scan incoming messages from messaging channels
    scan_messages: true
    # Scan memory files for poisoning
    scan_memory: true
    # Detect CSS-hidden instructions (CVE-2026-22708)
    detect_hidden_instructions: true
    # Confidence threshold for blocking (0.0-1.0)
    confidence_threshold: 0.7

  # Hardening Auditor (Workstream 4) - Configuration security
  hardening_auditor:
    enabled: true
    # Periodic scan interval in minutes (0 = manual only)
    scan_interval_minutes: 60
    # Alert on configuration drift from last audit
    detect_drift: true
    # Check for internet exposure via Censys/Shodan
    check_exposure: true

  # Credential Guard (Workstream 5) - Data protection
  credential_guard:
    enabled: true
    # Monitor access to credential files
    monitor_credentials: true
    # Detect read-then-exfil patterns
    detect_exfiltration: true
    # Redact sensitive data in outbound communications
    redact_outbound: true
    # Audit plaintext credential storage
    audit_storage: true
